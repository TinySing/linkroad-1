webpackJsonp([4],{EDKx:function(e,t){},JAyg:function(e,t){},LLyI:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={name:"SystemMan",data:function(){return{searchDataTest:"",valueAdd:[],joinAddValue:[],total:null,totalOne:null,totalTest:null,currentPage:1,currentPageOne:1,currentPageTest:1,pageSize:5,pageSizeOne:6,pageSizeTest:8,centerDialog:!1,centerDialogOne:!1,options:[{value:"",label:"全部"},{value:"JT",label:"集团"},{value:"CX",label:"产险"},{value:"SX",label:"寿险"}],tableData:[],tableDataOne:[],tableDataTest:[],value:"",searchData:"",importantIndex:"",joiner:[],ownerShip:[],room:[],ownId:[],loading:!0}},created:function(){},methods:{handleDialogClose:function(){this.centerDialogOne=!1,this.searchDataTest=""},choose:function(e,t,n){var o=this;this.systemId=n[this.importantIndex].projectId,this.userId=t[e].people;var l=a("mw3O"),r={projectId:this.systemId,part:"1",userId:this.userId};this.$axios.post("/monitorCon/system/userProject/add",l.stringify(r)).then(function(e){"success"===e.data.type&&o.$message({message:"添加参与人员成功！",type:"success"}),"fail"===e.data.type&&o.$message.error("添加失败，此人已是该项目参与人！！！"),o.getSystem()})},searchButTest:function(){this.currentPageTest=1,this.getPerson(),""===this.searchDataTest&&alert("查询条件不能为空，请重新输入")},resetTest:function(){this.searchDataTest="",this.getPerson()},check:function(e,t){var n=this;this.importantIndex=e,this.projectId=t[e].projectId;var o=a("mw3O"),l={projectId:this.projectId};this.$axios.post("/monitorCon/system/appInfo/querySysByProject",o.stringify(l)).then(function(e){n.tableDataOne=[];for(var t=0;t<e.data.length;t++)null===e.data[t].networkregion&&null===e.data[t].env?n.tableDataOne.push({number:t+1,type:e.data[t].htype,ip:e.data[t].ip,network:"--",environment:"--"}):n.tableDataOne.push({number:t+1,type:e.data[t].htype,ip:e.data[t].ip,network:e.data[t].networkregion,environment:e.data[t].env});n.totalOne=n.tableDataOne.length})},searchBut:function(){this.currentPage=1,this.getSystem(),""===this.searchData&&alert("查询条件不能为空，请重新输入")},getPerson:function(){var e=this,t=a("mw3O"),n={pageNum:this.currentPageTest,pageSize:this.pageSizeTest,userInfo:this.searchDataTest};this.$axios.post("/monitorCon/system/user/query",t.stringify(n)).then(function(t){e.totalTest=t.data.total,e.tableDataTest=[];for(var a=0;a<t.data.list.length;a++)e.tableDataTest.push({people:t.data.list[a].userId,name:t.data.list[a].userName})})},reset:function(){this.value="",this.searchData="",this.getSystem()},changeCode:function(){this.currentPage=1,this.getSystem()},getSystem:function(){var e=this,t=a("mw3O"),n={userId:sessionStorage.getItem("userId"),pageNum:this.currentPage,pageSize:this.pageSize,projectInfo:this.searchData,companyCode:this.value};this.$axios.post("/monitorCon/system/project/queryCascadeProject",t.stringify(n)).then(function(t){e.total=t.data.total,e.tableData=[],e.joiner=[];for(var a=0;a<t.data.list.length;a++){"1"===t.data.list[a].enable?t.data.list[a].enable="正常":t.data.list[a].enable="停用";var n=t.data.list[a].projectname,o=t.data.list[a].projectMembers,l=t.data.list[a].projectid,r=t.data.list[a].projectOwners,s=t.data.list[a].enable;if(r.length>1){for(var i=0;i<r.length;i++)"JT"===r[i].companyCode&&(r[i].companyCode="集团"),"SX"===r[i].companyCode&&(r[i].companyCode="寿险"),"CX"===r[i].companyCode&&(r[i].companyCode="产险"),e.joiner.push(r[i].userName),e.ownId.push(r[i].userId);e.tableData.push({ownId:e.ownId,projectOwner:e.joiner,systemName:n,projectMembers:o,projectId:l,ownerShip:r[0].companyCode,describe:r[0].dept,validity:s})}else for(var c=0;c<r.length;c++)o.length>1&&(o=o.join(",")),"JT"===r[c].companyCode&&(r[c].companyCode="集团"),"SX"===r[c].companyCode&&(r[c].companyCode="寿险"),"CX"===r[c].companyCode&&(r[c].companyCode="产险"),e.tableData.push({ownId:r[c].userId,systemName:n,projectMembers:o,projectId:l,projectOwner:r[c].userName,ownerShip:r[c].companyCode,describe:r[c].dept,validity:s});0===r.length&&e.tableData.push({systemName:n,projectMembers:o,projectId:l,projectOwner:"暂无数据",validity:s})}e.loading=!1})},getAddIndex:function(e){this.getPerson(),this.centerDialogOne=!0,this.importantIndex=e},change:function(e){this.$forceUpdate()},handleSizeChange:function(e){this.pageSize=e,this.currentPage=1,this.getSystem()},handleCurrentChange:function(e){this.currentPage=e,this.getSystem()},handleCurrentChangeOne:function(e){this.currentPageOne=e},handleCurrentChangeTest:function(e){this.currentPageTest=e,this.getPerson()}},computed:{},mounted:function(){this.getSystem()},watch:{centerDialog:{handler:function(e,t){this.currentPageOne=1}}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"system_main"},[a("i",[e._v("当前位置：系统管理")]),e._v(" "),a("div",{staticClass:"top_area"},[a("el-input",{staticClass:"search",attrs:{type:"text",placeholder:"项目名称/项目编号"},on:{input:function(t){return e.change(t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchBut(t)}},model:{value:e.searchData,callback:function(t){e.searchData=t},expression:"searchData"}}),e._v(" "),a("div",{staticClass:"but"},[a("button",{on:{click:e.searchBut}},[e._v("查询")]),e._v(" "),a("button",{staticStyle:{"margin-left":"15px!important"},on:{click:e.reset}},[e._v("重置")])]),e._v(" "),a("el-select",{staticStyle:{float:"right",width:"105px","margin-top":"2.5vh","margin-right":"28px"},attrs:{filterable:"",placeholder:e.value,size:"small"},on:{change:function(t){return e.changeCode()}},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.options,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),a("div",{staticClass:"bottom_area",staticStyle:{padding:"3vh 15px 0"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",display:"block","max-height":"51vh",overflow:"auto","font-size":"12px"},attrs:{"header-cell-style":{background:"#f0f5f9",color:"#666",borderRight:"none"},data:e.tableData,"element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(251, 255, 242, 0.8)",border:"",height:"80%"}},[a("el-table-column",{attrs:{prop:"describe",label:"系统描述",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("p",{staticStyle:{"text-align":"left","line-height":"20px"}},[e._v("系统名称："+e._s(t.row.systemName))]),e._v(" "),a("p",{staticStyle:{"text-align":"left","line-height":"18px"}},[e._v("系统归属："+e._s(t.row.ownerShip))]),e._v(" "),a("p",{staticStyle:{"text-align":"left","line-height":"18px"}},[e._v("负责处室："+e._s(t.row.describe))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"projectOwner",label:"系统负责人",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"projectMembers",label:"系统参与人",align:"center","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{prop:"man",label:"关联设备情况",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{on:{click:function(t){e.centerDialog=!0}}},[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.check(t.$index,e.tableData)}}},[e._v("\n              查看\n            ")])],1),e._v(" "),a("el-dialog",{attrs:{title:"系统相关设备","close-on-click-modal":!1,visible:e.centerDialog,center:""},on:{"update:visible":function(t){e.centerDialog=t}}},[a("div",{staticClass:"diaBox",staticStyle:{margin:"15px 2vh 0 2vh","padding-bottom":"15px"}},[a("el-table",{attrs:{"header-cell-style":{background:"#f0f5f9",color:"#666",height:"28px"},data:e.tableDataOne.slice((e.currentPageOne-1)*e.pageSizeOne,e.currentPageOne*e.pageSizeOne),border:""}},[a("el-table-column",{attrs:{prop:"number",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"type",label:"设备类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"ip",label:"设备IP"}}),e._v(" "),a("el-table-column",{attrs:{prop:"network",label:"所处网段"}}),e._v(" "),a("el-table-column",{attrs:{prop:"environment",label:"所处环境"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"block",staticStyle:{"margin-left":"auto"}},[a("el-pagination",{attrs:{"current-page":e.currentPageOne,"page-size":e.pageSizeOne,layout:"total, prev, pager, next",total:e.totalOne},on:{"current-change":e.handleCurrentChangeOne}})],1)])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"validity",label:"系统有效性",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"address",label:"操作",align:"center",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{"text-decoration":"underline"},attrs:{type:"text",size:"small"},on:{click:function(a){return e.getAddIndex(t.$index,t.row)}}},[e._v("\n            添加\n          ")]),e._v(" "),a("el-dialog",{attrs:{title:"系统相关人员","before-close":e.handleDialogClose,"close-on-click-modal":!1,visible:e.centerDialogOne,width:"633",center:""},on:{"update:visible":function(t){e.centerDialogOne=t}}},[a("div",{staticClass:"diaBox",staticStyle:{"margin-top":"10px","margin-left":"2.7vh"}},[a("el-input",{staticClass:"search",attrs:{type:"text",placeholder:"姓名/用户名"},on:{input:function(t){return e.change(t)}},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.searchButTest(t)}},model:{value:e.searchDataTest,callback:function(t){e.searchDataTest=t},expression:"searchDataTest"}}),e._v(" "),a("div",{staticClass:"but"},[a("button",{on:{click:e.searchButTest}},[e._v("查询")]),e._v(" "),a("button",{staticStyle:{"margin-left":"15px!important"},on:{click:e.resetTest}},[e._v("重置")])]),e._v(" "),a("el-table",{staticStyle:{width:"100%",display:"block","font-size":"12px","max-height":"51vh",overflow:"auto"},attrs:{"header-cell-style":{background:"#f0f5f9",color:"#666",borderRight:"none"},data:e.tableDataTest,border:""}},[a("el-table-column",{attrs:{prop:"people",label:"人员用户名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"人员姓名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"handle",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{cursor:"pointer"},on:{click:function(a){return e.choose(t.$index,e.tableDataTest,e.tableData)}}},[a("el-button",{staticStyle:{"font-size":"14px"},attrs:{type:"text",size:"small"}},[e._v("\n                        点击添加\n                      ")])],1)]}}],null,!0)})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"block",staticStyle:{width:"600px",height:"6vh","margin-top":"3vh",left:"40vw"}},[a("el-pagination",{attrs:{background:"","current-page":e.currentPageTest,"page-size":e.pageSizeTest,layout:"total,prev, pager, next",total:e.totalTest},on:{"current-change":e.handleCurrentChangeTest}})],1)])])]}}])})],1),e._v(" "),a("div",{staticClass:"block",staticStyle:{width:"600px",height:"6vh","margin-top":"3vh",left:"40vw"}},[a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-sizes":[5,10,20,30],"page-size":e.pageSize,layout:"total,sizes,prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)])},staticRenderFns:[]};var l=a("VU/8")(n,o,!1,function(e){a("EDKx"),a("JAyg")},"data-v-0d8987ba",null);t.default=l.exports}});
//# sourceMappingURL=4.a715edc4b6d93fb6b863.js.map